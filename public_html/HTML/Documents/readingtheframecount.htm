<?xml version="1.0" encoding="utf-8"?>
<html><head><title>Reading the frame count</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><link rel="stylesheet" type="text/css" href="../Theme/nav.css" /><link rel="stylesheet" type="text/css" href="../Theme/popupmenu.css" /><link rel="stylesheet" type="text/css" href="../Theme/lf.css" /><link rel="stylesheet" type="text/css" href="../LinksExt/C1H_HTML.css" /><link rel="stylesheet" type="text/css" href="../LinksExt/C3D User Guide.css" />
<script type="text/javascript">
//<![CDATA[



var _needIndentation = false;




//]]></script>

<script language="JavaScript" src="../linker.js" type="text/JavaScript"></script>

<script language="JavaScript" src="../special.js" type="text/JavaScript"></script>

<script language="JavaScript" src="../common.js" type="text/JavaScript"></script>

<meta name="Generator" content="ComponentOne Doc-To-Help v.2009.3.0.500" />
<meta name="D2HTheme" content="C3D v.138" />
</head>
<body onload="d2hOnLoadToolbar(event);" style="OVERFLOW: hidden; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: transparent" relpart="../">
<script language="javascript" type="text/javascript">
//<![CDATA[



d2hTopicPreOpen();



d2hTrySyncTOC();







var prev = true;





var next = true;



if (typeof d2hInitMainThemeHandlers != "undefined")

    d2hInitMainThemeHandlers(prev, next);

d2hAdjustTopicBorders(document);    



if (typeof d2hLoadWindows != "undefined")

    d2hLoadWindows();

if (typeof d2hLoadNavUrls != "undefined")

    d2hLoadNavUrls();




//]]></script>

<div id="D2HTopicOuterBody" class="d2h_outer_topic" style="OVERFLOW: auto; HEIGHT: 100%; WIDTH: 100%; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: transparent">
<div id="nsbanner" class="d2hNavigatorTopic">
<div id="TitleRow" class="d2h_main_titlerow" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px">
<div style="DISPLAY: none"><a id="D2HPreviousAnchor" href="thec3dframecount.htm"></a><a id="D2HNextAnchor" href="writingthec3dframecount1.htm"></a></div>
<script language="JavaScript" type="text/JavaScript">
//<![CDATA[

var USE_FLAT_BUTTONS = true;

var BTN_SELECTED = "";

var BTN_HOVER = "";

var IS_MODERN = false;

var HAS_MARGIN_CLASSIC_BORDER = false;


//]]></script>

<div id="ienav" class="d2h_main_ienav">
<table id="tblNavigator" class="D2HTopicToolbarOuter" cellspacing="0" cellpadding="0" width="100%" border="0">
  <tbody>
  <tr class="D2HTopicToolbarOuter">
    <td class="D2HTopicToolbar" align="left">
      <table class="D2HTopicToolbar" style="MARGIN-LEFT: 4px" cellspacing="0" cellpadding="0">
        <tbody>
        <tr class="D2HTopicToolbar">
          <td class="D2HTopicToolbar">
            <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
              <tbody>
              <tr class="D2HTopicToolbar">
                <td id="D2HBreadcrumbs" class="d2hCellTopic" nowrap="" caption=""><a target="right"><span class="D2HBreadcrumbsUnselected"><a class="d2h_breadcrumbsNormal" href="appendix.htm">Appendix</a><span class="d2h_breadcrumbsLinkSeparator"> &gt; </span><a class="d2h_breadcrumbsNormal" href="thec3dframecount.htm">The 
                  C3D frame count</a><span style="TEXT-DECORATION: none"> </span></span></a></td></tr></tbody></table></td>
          <td class="D2HTopicToolbar" nowrap=""><span class="D2HBreadcrumbsUnselected" style="TEXT-DECORATION: none"> </span></td></tr></tbody></table></td>
    <td class="D2HTopicToolbar" align="center">
      <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
        <tbody>
        <tr class="D2HTopicToolbar"></tr></tbody></table></td>
    <td class="D2HTopicToolbar" align="right">
      <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
        <tbody>
        <tr class="D2HTopicToolbar">
          <td class="D2HTopicToolbar" nowrap=""><span class="D2HEmailUnselected" style="TEXT-DECORATION: none"> </span></td>
          <td class="D2HTopicToolbar">
            <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
              <tbody>
              <tr class="D2HTopicToolbar">
                <td onclick="d2hCommand('D2HEmail')" id="D2HEmail" class="d2hCellTopic" nowrap=""><a href="javascript:void(0);"><span class="D2HEmailUnselected">Email<span style="TEXT-DECORATION: none"> </span></span></a></td></tr></tbody></table></td>
          <td class="D2HTopicToolbar" width="5" nowrap=""> </td></tr></tbody></table></td></tr></tbody></table></div></div>
<script language="javascript" type="text/javascript">
//<![CDATA[

if (typeof d2hProcessTopicNavForCSH != "undefined")

    d2hProcessTopicNavForCSH();


//]]></script>
</div>
<div id="nstext" class="d2h_main_nstext" style="PADDING-BOTTOM: 10px; PADDING-TOP: 5px; PADDING-LEFT: 22px; PADDING-RIGHT: 10px" valign="bottom">
<h3>Reading the frame count</h3>
<p class="MsoBodyText">When a C3D file is opened, the number of frames stored in 
the file is normally read from the C3D parameter <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES.  I</span></span>t is important that 
applications determine the parameter storage type when they open a parameter, 
before reading the parameter value.  Traditionally the C3D frame count 
stored in the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter was a signed <a onclick="return d2hpopup(event, this.href)" id="popup_104128" href="gloss_integer.htm">integer</a>, but it may also be stored as an unsigned 
integer, or a <a onclick="return d2hpopup(event, this.href)" id="popup_104124" href="gloss_floatingpoint1.htm">floating-point</a> value.  So applications 
opening the C3D file must be written correctly and must determine the parameter 
type before reading the parameter.</p>
<p class="MsoBodyText">When a C3D file is opened, the following rules need to 
apply to reading the frame count from file that may have different vendors’ 
interpretations of the C3D standard:</p>
<p class="MsoBodyText" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt; tab-stops: 162.0pt">1.  If 
the value stored in the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter is not 65535, then 
the value stored in <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> is the C3D frame count. Note 
that the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter may have been 
written as a positive signed 16-bit integer, an unsigned 16-bit integer, or a 
floating-point value.</p>
<p class="MsoBodyText" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt; tab-stops: 162.0pt">2.  If 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter value is 65535 then 
it is likely that the C3D file contains more than 65535 frames, with the actual 
frame count stored in one of two different vendor defined <a onclick="return d2hpopup(event, this.href)" id="popup_104125" href="gloss_parameters.htm">parameters</a>.  If the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:LONG_FRAMES</span></span> 
and <span class="ParameterChar"><span style="FONT-SIZE: 9pt"><a onclick="return d2hpopup(event, this.href)" id="popup_104130" href="gloss_trial.htm"><span class="ParameterChar"><span style="FONT-SIZE: 9pt">TRIAL</span></span></a></span></span> parameters do not 
exist, then 65535 is the actual C3D frame count.</p>
<p class="MsoBodyText" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt; tab-stops: 162.0pt">3.  If 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter value is 65535 and 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">TRIAL</span></span> 
parameters exist, then the C3D frame count must be calculated from the two 
values stored in the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">TRIAL:ACTUAL_START_FIELD</span></span> and the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">TRIAL:ACTUAL_END_FIELD</span></span> parameters.</p>
<p class="MsoBodyText" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt; tab-stops: 162.0pt">4.  If 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter value is 65535 and 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:LONG_FRAMES</span></span> parameter exists, then 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:LONG_FRAMES</span></span> contains the frame count 
stored as a floating-point value.</p>
<p class="MsoBodyText" style="MARGIN-LEFT: 18pt; TEXT-INDENT: -18pt; tab-stops: 162.0pt">5.  If 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:FRAMES</span></span> parameter value is 65535 and 
both the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">TRIAL</span></span> parameters and the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:LONG_FRAMES</span></span> 
parameters exist, then they should both contain identical frame counts.</p>
<p class="MsoBodyText">While these rules describe the actual C3D data frame count, 
a potential complication is that the C3D file header stores the frame range of 
the <em><span style="FONT-FAMILY: &quot;Verdana&quot;,&quot;sans-serif&quot;"><a onclick="return d2hpopup(event, this.href)" id="popup_104126" href="gloss_rawdata.htm"><em><span style="FONT-FAMILY: &quot;Verdana&quot;,&quot;sans-serif&quot;">raw data</span></em></a></span></em> 
that generated the <a onclick="return d2hpopup(event, this.href)" id="popup_104129" href="gloss_3ddata.htm">3D data</a> stored in the C3D 
file.  The original <em><span style="FONT-FAMILY: &quot;Verdana&quot;,&quot;sans-serif&quot;">raw data</span></em> frame range is 
stored as two 16-bit integers in header words 4 and 5 that record the first and 
last frame numbers of the <em><span style="FONT-FAMILY: &quot;Verdana&quot;,&quot;sans-serif&quot;">raw data</span></em> that created 
the 3D data values stored in the file.  While there is a potential 
relationship between the frame numbers stored in the header, and the frames 
stored as C3D data, the header values do not define the C3D file frame 
count.</p>
<p class="MsoBodyText">Some applications may incorrectly expect the header frame 
values to define the C3D file frame range but in normal circumstances, when 
reading or processing data in a C3D file, the C3D file header <em><span style="FONT-FAMILY: &quot;Verdana&quot;,&quot;sans-serif&quot;">raw frame range values</span></em> 
should be ignored because they do not define the C3D file frame count and any 
changes to the C3D file frame count may not change the header values.</p>
<p class="MsoBodyText">Once the C3D file frame count has been determined using the 
methods described above, it is recommended that all applications processing data 
from C3D files work with their internal <a onclick="return d2hpopup(event, this.href)" id="popup_104127" href="gloss_3dframe.htm">3D frame</a> indexes defined as 32-bit unsigned 
integers to avoid internal application integer overflow problems when processing 
data from large files.</p></div></div></body></html>
