<?xml version="1.0" encoding="utf-8"?>
<html><head><title>Analog Data Storage</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><link rel="stylesheet" type="text/css" href="../Theme/nav.css" /><link rel="stylesheet" type="text/css" href="../Theme/popupmenu.css" /><link rel="stylesheet" type="text/css" href="../Theme/lf.css" /><link rel="stylesheet" type="text/css" href="../LinksExt/C1H_HTML.css" /><link rel="stylesheet" type="text/css" href="../LinksExt/C3D User Guide.css" />
<script type="text/javascript">
//<![CDATA[



var _needIndentation = false;




//]]></script>

<script language="JavaScript" src="../linker.js" type="text/JavaScript"></script>

<script language="JavaScript" src="../special.js" type="text/JavaScript"></script>

<script language="JavaScript" src="../common.js" type="text/JavaScript"></script>

<meta name="Generator" content="ComponentOne Doc-To-Help v.2009.3.0.500" />
<meta name="D2HTheme" content="C3D v.138" />
</head>
<body onload="d2hOnLoadToolbar(event);" style="OVERFLOW: hidden; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: transparent" relpart="../">
<script language="javascript" type="text/javascript">
//<![CDATA[



d2hTopicPreOpen();



d2hTrySyncTOC();







var prev = true;





var next = true;



if (typeof d2hInitMainThemeHandlers != "undefined")

    d2hInitMainThemeHandlers(prev, next);

d2hAdjustTopicBorders(document);    



if (typeof d2hLoadWindows != "undefined")

    d2hLoadWindows();

if (typeof d2hLoadNavUrls != "undefined")

    d2hLoadNavUrls();




//]]></script>

<div id="D2HTopicOuterBody" class="d2h_outer_topic" style="OVERFLOW: auto; HEIGHT: 100%; WIDTH: 100%; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: transparent">
<div id="nsbanner" class="d2hNavigatorTopic">
<div id="TitleRow" class="d2h_main_titlerow" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; PADDING-RIGHT: 0px">
<div style="DISPLAY: none"><a id="D2HPreviousAnchor" href="cameracontributionmask.htm"></a><a id="D2HNextAnchor" href="analogdataintegerformat.htm"></a></div>
<script language="JavaScript" type="text/JavaScript">
//<![CDATA[

var USE_FLAT_BUTTONS = true;

var BTN_SELECTED = "";

var BTN_HOVER = "";

var IS_MODERN = false;

var HAS_MARGIN_CLASSIC_BORDER = false;


//]]></script>

<div id="ienav" class="d2h_main_ienav">
<table id="tblNavigator" class="D2HTopicToolbarOuter" cellspacing="0" cellpadding="0" width="100%" border="0">
  <tbody>
  <tr class="D2HTopicToolbarOuter">
    <td class="D2HTopicToolbar" align="left">
      <table class="D2HTopicToolbar" style="MARGIN-LEFT: 4px" cellspacing="0" cellpadding="0">
        <tbody>
        <tr class="D2HTopicToolbar">
          <td class="D2HTopicToolbar">
            <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
              <tbody>
              <tr class="D2HTopicToolbar">
                <td id="D2HBreadcrumbs" class="d2hCellTopic" nowrap="" caption=""><a target="right"><span class="D2HBreadcrumbsUnselected"><a class="d2h_breadcrumbsNormal" href="the3dpointdatasection.htm">The 3D Point Data 
                  Section</a><span style="TEXT-DECORATION: none"> </span></span></a></td></tr></tbody></table></td>
          <td class="D2HTopicToolbar" nowrap=""><span class="D2HBreadcrumbsUnselected" style="TEXT-DECORATION: none"> </span></td></tr></tbody></table></td>
    <td class="D2HTopicToolbar" align="center">
      <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
        <tbody>
        <tr class="D2HTopicToolbar"></tr></tbody></table></td>
    <td class="D2HTopicToolbar" align="right">
      <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
        <tbody>
        <tr class="D2HTopicToolbar">
          <td class="D2HTopicToolbar" nowrap=""><span class="D2HEmailUnselected" style="TEXT-DECORATION: none"> </span></td>
          <td class="D2HTopicToolbar">
            <table class="D2HTopicToolbar" cellspacing="0" cellpadding="0">
              <tbody>
              <tr class="D2HTopicToolbar">
                <td onclick="d2hCommand('D2HEmail')" id="D2HEmail" class="d2hCellTopic" nowrap=""><a href="javascript:void(0);"><span class="D2HEmailUnselected">Email<span style="TEXT-DECORATION: none"> </span></span></a></td></tr></tbody></table></td>
          <td class="D2HTopicToolbar" width="5" nowrap=""> </td></tr></tbody></table></td></tr></tbody></table></div></div>
<script language="javascript" type="text/javascript">
//<![CDATA[

if (typeof d2hProcessTopicNavForCSH != "undefined")

    d2hProcessTopicNavForCSH();


//]]></script>
</div>
<div id="nstext" class="d2h_main_nstext" style="PADDING-BOTTOM: 10px; PADDING-TOP: 5px; PADDING-LEFT: 22px; PADDING-RIGHT: 10px" valign="bottom">
<h2>Analog Data Storage</h2>
<p class="MsoBodyText">Although the method of storing the analog sample values is 
different between the <a onclick="return d2hpopup(event, this.href)" id="popup_103832" href="gloss_integer.htm">Integer</a> and <a onclick="return d2hpopup(event, this.href)" id="popup_103828" href="gloss_floatingpoint1.htm">Floating-point</a> versions of the C3D file 
format, both versions organize the individual analog data samples in the same 
way within the <a onclick="return d2hpopup(event, this.href)" id="popup_103833" href="gloss_3ddata.htm">3D Data</a> <a onclick="return d2hpopup(event, this.href)" id="popup_103834" href="gloss_section.htm">section</a> of the C3D file.  The analog record 
for each <a onclick="return d2hpopup(event, this.href)" id="popup_103831" href="gloss_3dframe.htm">3D frame</a> can contain one or more analog data 
samples where each <a onclick="return d2hpopup(event, this.href)" id="popup_103827" href="gloss_analogdatasample.htm">analog data sample</a> 
consists of one or more analog measurements (channels) usually recorded from an 
<a onclick="return d2hpopup(event, this.href)" id="popup_103836" href="gloss_adc.htm">ADC</a> (analog to digital converter) during the 3D frame 
sample period.  The parameter <span class="ParameterChar"><span style="FONT-SIZE: 9pt">ANALOG:RATE</span></span> stores the total number of 
analog data samples per 3D frame while the parameter <span class="ParameterChar"><span style="FONT-SIZE: 9pt">ANALOG:USED</span></span> 
stores the number of analog measurements, or channels, within each analog data 
sample.  All of this data is recorded at a 3D frame rate whose value is 
recorded in the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:RATE</span></span> parameter.</p>
<p class="MsoBodyText">The C3D file format is designed to store synchronized 3D 
data and analog data; 3D measurements are recorded at fixed intervals (set by 
the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:RATE</span></span> parameter) and multiple analog 
samples, recorded at fixed intervals within each 3D frame, are stored with each 
3D frame in the 3D/Analog data section of the C3D file.  For example, if 
the 3D data is sampled every 20ms (50Hz frame rate) and each 3D frame has 5 
analog samples then the analog data is sampled every 2ms within the 3D 
frame.</p>
<p class="MsoBodyText">Thus, when analog data is present in the C3D file, each 3D 
frame is followed by one or more analog samples for each analog channel.  
These are organized as shown below where “N” is the number of analog 
measurements per 3D frame (stored in word 10 of the C3D file header), and “n” is 
the number of analog channels that are stored in the C3D file.  The number 
of channels sampled is not stored in the C3D header directly but can be 
calculated as (Word 3) / (Word 10) or (total analog samples per 3D frame) / 
(number of samples per analog channel) or read from the parameter data 
section:</p>
<p class="MsoBodyText" style="PAGE-BREAK-AFTER: avoid"><img style="HEIGHT: 173.3pt; WIDTH: 216pt" border="0" src="../ImagesExt/image9_27.png" alt="" /></p>
<p class="MsoCaption" style="MARGIN-LEFT: 0pt">Figure 29 - The organization of N 
samples of n channels analog data</p>
<p class="MsoBodyText">For example, consider a C3D file that contains <a onclick="return d2hpopup(event, this.href)" id="popup_103830" href="gloss_3dpoint.htm">3D point</a> information that has been recorded at 
60Hz, and contains 18 analog channels that have each been sampled at a rate of 
1200 samples per second.  This information is stored in the C3D file in the 
following <a onclick="return d2hpopup(event, this.href)" id="popup_103829" href="gloss_parameters.htm">parameters</a>:</p>
<p class="Parameter" style="MARGIN-LEFT: 36pt">POINT:RATE = 60</p>
<p class="Parameter" style="MARGIN-LEFT: 36pt">ANALOG:USED = 18</p>
<p class="Parameter" style="MARGIN-LEFT: 36pt">ANALOG:RATE = 1200</p>
<p class="MsoBodyText">Thus the analog data will be written with each individual 
analog record containing eighteen values – one value per analog channel recorded 
in the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">ANALOG:USED</span></span> parameter.  Each analog 
channel is sampled twenty times per 3D frame of data and there will be sixty 3D 
frames per second as recorded in the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:RATE</span></span> parameter.  The C3D file 
does not directly store the number of analog data samples per frame as a 
parameter; this value is calculated by dividing the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">ANALOG:RATE</span></span> value 
by the <span class="ParameterChar"><span style="FONT-SIZE: 9pt">POINT:RATE</span></span> value. So each 3D frame of data 
recorded at 60Hz will contain twenty sets of analog samples, each recording 
eighteen analog channels.</p>
<p class="MsoBodyText">The number of analog data samples per 3D frame value is 
stored in word 10 of the C3D file header, together with a count of the total 
number of analog samples per 3D frame in word 3, so that the analog data can be 
quickly read by any application that opens a C3D file without having to read and 
interpret values from the parameter section of the C3D file.</p>
<p class="MsoBodyText">The synchronization, or timing accuracy of the 3D and 
analog data, depends on the hardware data collection system and the signal 
latency of any devices connected to the analog sampling system.  While the 
C3D format is capable of recording 3D and analog data with perfect 
synchronization, analog devices connected to a 3D data collection system by a 
USB interface, may have significant signal latencies that can result poor 
synchronization of the recorded data.</p>
<p class="MsoBodyText">It is the responsibility of the Motion Capture system to 
document the latencies of each of the sensors being sampled and remove any 
delays from the data when the C3D file is created.  Any temporal processing 
of the data should be recorded in the file parameters, documenting the 
manipulation of the data so that any subsequent analysis of the data knows what 
has been done.</p>
<p class="MsoBodyText">Users can verify the system synchronization by applying a 
common input signal to each sensor simultaneously.  For example, place a 
small loudspeaker or microphone, connected to an EMG input, on a force plate, 
and then drop a golf ball, covered in retro-reflective tape or attached to a 
marker onto the plate.  The marker trajectory will change as it strikes the 
force plate, generating a small vertical force signal and the loudspeaker or 
microphone will record the impact via the EMG input at the same instant – 
resulting in a C3D file with one common stimulus recorded through each sensor as 
shown below:</p>
<p class="MsoBodyText" style="PAGE-BREAK-AFTER: avoid"><img style="HEIGHT: 342.8pt; WIDTH: 336pt" border="0" src="../ImagesExt/image9_28.png" alt="" /></p>
<p class="MsoCaption" style="MARGIN-LEFT: 0pt">Figure 30 - A synchronization test 
showing a 3D trajectory, force vector, and EMG input.</p>
<p class="MsoBodyText">The synchronization test illustrated above was performed 
with a high 3D frame rate of 250 frames per second and eight analog samples per 
frame.  The high sample rates allow the data collection to measure the 
force plate signal latency of 4ms (one 3D frame) and the EMG signal latency of 
3.75ms.</p>
<p class="MsoBodyText">This test allows the individual sensor latency to be 
determined, but the overall the data collection synchronization accuracy needs a 
second test, dropping the golf ball again after a typical <a onclick="return d2hpopup(event, this.href)" id="popup_103835" href="gloss_trial.htm">trial</a> period.  If the data collection sampling 
rate is accurate then both tests, at the start of the data collection and the 
end of the data collection, will result in identical measurements.</p>
<p class="MsoBodyText">Any difference in the measurements at the start of the 
trial and the measurements at the end of the trial indicate that the 3D point 
sample rate and the <a onclick="return d2hpopup(event, this.href)" id="popup_103826" href="gloss_analogsamplerate.htm">analog sample rate</a> were 
not accurately synchronized when the data was sampled and the file 
created.  This may be a result of the recorded 3D sample rate data being 
set to 60Hz, with the 3D samples recording in synchronization with video data 
recorded at 59.94Hz which results in a 16us synchronization error in the second 
frame in the C3D file, an error of 0.5ms (16us*60) after one second, increasing 
to an error of 58ms (16us*60*60) at the end of a one minute trial.</p>
<p class="RelatedHead">More:</p>
<p class="MsoNormal"><a style="TEXT-DECORATION: none" href="analogdataintegerformat.htm"><img border="0" alt="" src="../button.gif" align="absMiddle" />Analog Data - Integer Format</a></p>
<p class="MsoNormal"><a style="TEXT-DECORATION: none" href="analogdatafloatingpointformat.htm"><img border="0" alt="" src="../button.gif" align="absMiddle" />Analog Data - Floating-point 
format</a></p></div></div></body></html>
